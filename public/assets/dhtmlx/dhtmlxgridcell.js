//v.3.5 build 120822
/*
Copyright DHTMLX LTD. http://www.dhtmlx.com
You allowed to use this component or parts of it under GPL terms
To use it on other terms or get Professional edition of the component please contact us at sales@dhtmlx.com
*/
function dhtmlXGridCellObject(e){this.destructor=function(){return this.base=this.grid=this.cell=this.cell.obj=null},this.cell=e,this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell.innerHTML._dhx_trim()},this.getMathValue=function(){return this.cell.original?this.cell.original:this.getValue()},this.getFont=function(){arOut=Array(3),this.cell.style.fontFamily&&(arOut[0]=this.cell.style.fontFamily);if(this.cell.style.fontWeight=="bold"||this.cell.parentNode.style.fontWeight=="bold")arOut[1]="bold";if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic")arOut[1]+="italic";return arOut[2]=this.cell.style.fontSize?this.cell.style.fontSize:"",arOut.join("-")},this.getTextColor=function(){return this.cell.style.color?this.cell.style.color:"#000000"},this.getBgColor=function(){return this.cell.bgColor?this.cell.bgColor:"#FFFFFF"},this.getHorAlign=function(){return this.cell.style.textAlign?this.cell.style.textAlign:this.cell.style.textAlign?this.cell.style.textAlign:"left"},this.getWidth=function(){return this.cell.scrollWidth},this.setFont=function(e){fntAr=e.split("-"),this.cell.style.fontFamily=fntAr[0],this.cell.style.fontSize=fntAr[fntAr.length-1],fntAr.length==3&&(/bold/.test(fntAr[1])&&(this.cell.style.fontWeight="bold"),/italic/.test(fntAr[1])&&(this.cell.style.fontStyle="italic"),/underline/.test(fntAr[1])&&(this.cell.style.textDecoration="underline"))},this.setTextColor=function(e){this.cell.style.color=e},this.setBgColor=function(e){e==""&&(e=null),this.cell.bgColor=e},this.setHorAlign=function(e){this.cell.style.textAlign=e.length==1?e=="c"?"center":e=="l"?"left":"right":e},this.wasChanged=function(){return this.cell.wasChanged?!0:!1},this.isCheckbox=function(){var e=this.cell.firstChild;return e&&e.tagName=="INPUT"?(type=e.type,type=="radio"||type=="checkbox"?!0:!1):!1},this.isChecked=function(){if(this.isCheckbox())return this.cell.firstChild.checked},this.isDisabled=function(){return this.cell._disabled},this.setChecked=function(e){this.isCheckbox()&&(e!="true"&&e!=1&&(e=!1),this.cell.firstChild.checked=e)},this.setDisabled=function(e){e!="true"&&e!=1&&(e=!1),this.isCheckbox()&&(this.cell.firstChild.disabled=e,this.disabledF&&this.disabledF(e)),this.cell._disabled=e}}function eXcell(){this.val=this.obj=null,this.changeState=function(){return!1},this.edit=function(){this.val=this.getValue()},this.detach=function(){return!1},this.getPosition=function(e){for(var t=e,n=0,r=0;t.tagName!="BODY";)n+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;return[n,r]}}function eXcell_ed(e){e&&(this.cell=e,this.grid=this.cell.parentNode.grid),this.edit=function(){this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA",this.val=this.getValue(),this.obj=document.createElement(this.cell.atag),this.obj.setAttribute("autocomplete","off"),this.obj.style.height=this.cell.offsetHeight-(_isIE?4:4)+"px",this.obj.className="dhx_combo_edit",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.style.textAlign,this.obj.onclick=function(e){(e||event).cancelBubble=!0},this.obj.onmousedown=function(e){(e||event).cancelBubble=!0},this.obj.value=this.val,this.cell.innerHTML="",this.cell.appendChild(this.obj),this.obj.onselectstart=function(e){return e||(e=event),e.cancelBubble=!0},_isIE&&this.obj.focus(),this.obj.focus()},this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()},this.detach=function(){return this.setValue(this.obj.value),this.val!=this.getValue()}}function eXcell_edtxt(e){e&&(this.cell=e,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(e){!e||e.toString()._dhx_trim()==""?(e=" ",this.cell._clearCell=!0):this.cell._clearCell=!1,this.setCTxtValue(e)}}function eXcell_ch(e){e&&(this.cell=e,this.grid=this.cell.parentNode.grid),this.disabledF=function(e){this.cell.innerHTML=e==1||e==1?this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis."):this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")},this.changeState=function(e){e===!0&&!this.grid.isActive&&(window.globalActiveDHTMLGridObject!=null&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive&&window.globalActiveDHTMLGridObject.setActive(!1),this.grid.setActive(!0)),this.grid.isEditable&&!this.cell.parentNode._locked&&!this.isDisabled()&&(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null)},this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"},this.isCheckbox=function(){return!0},this.isChecked=function(){return this.getValue()=="1"?!0:!1},this.setChecked=function(e){this.setValue(e.toString())},this.detach=function(){return this.val!=this.getValue()},this.edit=null}function eXcell_ra(e){this.base=eXcell_ch,this.base(e),this.grid=e.parentNode.grid,this.disabledF=function(e){this.cell.innerHTML=e==1||e==1?this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis."):this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")},this.changeState=function(e){(e!==!1||this.getValue()!=1)&&this.grid.isEditable&&!this.cell.parentNode._locked&&(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=0?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null)},this.edit=null}function eXcell_txt(e){e&&(this.cell=e,this.grid=this.cell.parentNode.grid),this.edit=function(){this.val=this.getValue(),this.obj=document.createElement("TEXTAREA"),this.obj.className="dhx_textarea",this.obj.onclick=function(e){(e||event).cancelBubble=!0};var e=this.grid.getPosition(this.cell);this.obj.value=this.val,this.obj.style.display="",this.obj.style.textAlign=this.cell.style.textAlign;if(_isFF){var t=document.createElement("DIV");t.appendChild(this.obj),t.style.overflow="auto",t.className="dhx_textarea",this.obj.style.margin="0px 0px 0px 0px",this.obj.style.border="0px",this.obj=t}document.body.appendChild(this.obj),_isOpera&&(this.obj.onkeypress=function(e){if(e.keyCode==9)return!1}),this.obj.onkeydown=function(e){var t=e||event;if(t.keyCode==9)return globalActiveDHTMLGridObject.entBox.focus(),globalActiveDHTMLGridObject.doKey({keyCode:t.keyCode,shiftKey:t.shiftKey,srcElement:"0"}),!1},this.obj.style.left=e[0]+"px",this.obj.style.top=e[1]+this.cell.offsetHeight+"px";var n=this.cell.offsetWidth<200?200:this.cell.offsetWidth;this.obj.style.width=n+(_isFF?18:16)+"px",_isFF&&(this.obj.firstChild.style.width=parseInt(this.obj.style.width)+"px",this.obj.firstChild.style.height=this.obj.offsetHeight-3+"px"),_isIE&&(this.obj.select(),this.obj.value=this.obj.value),_isFF?this.obj.firstChild.focus():this.obj.focus()},this.detach=function(){var e="",e=_isFF?this.obj.firstChild.value:this.obj.value;return this.cell._clearCell=e==""?!0:!1,this.setValue(e),document.body.removeChild(this.obj),this.obj=null,this.val!=this.getValue()},this.getValue=function(){return this.obj?_isFF?this.obj.firstChild.value:this.obj.value:this.cell._clearCell?"":this.grid.multiLine?this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim():this.cell._brval||this.cell.innerHTML}}function eXcell_txttxt(e){e&&(this.cell=e,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell._clearCell?"":!this.grid.multiLine&&this.cell._brval?this.cell._brval:_isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(e){this.cell._brval=e,!e||e.toString()._dhx_trim()==""?(e=" ",this.cell._clearCell=!0):this.cell._clearCell=!1,this.setCTxtValue(e)}}function eXcell_co(e){e&&(this.cell=e,this.grid=this.cell.parentNode.grid,this.combo=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),this.editable=!0),this.shiftNext=function(){var e=this.list.options[this.list.selectedIndex+1];return e&&(e.selected=!0),this.obj.value=this.list.options[this.list.selectedIndex].text,!0},this.shiftPrev=function(){if(this.list.selectedIndex!=0){var e=this.list.options[this.list.selectedIndex-1];e&&(e.selected=!0),this.obj.value=this.list.options[this.list.selectedIndex].text}return!0},this.edit=function(){this.val=this.getValue(),this.text=this.getText()._dhx_trim();var e=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA"),this.obj.className="dhx_combo_edit",this.obj.style.height=this.cell.offsetHeight-4+"px",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.style.textAlign,this.obj.onclick=function(e){(e||event).cancelBubble=!0},this.obj.onmousedown=function(e){(e||event).cancelBubble=!0},this.obj.value=this.text,this.obj.onselectstart=function(e){return e||(e=event),e.cancelBubble=!0};var t=this;this.obj.onkeyup=function(e){var n=(e||event).keyCode;if(n!=38&&n!=40&&n!=9)for(var r=this.readonly?String.fromCharCode(n):this.value,i=t.list.options,s=0;s<i.length;s++)if(i[s].text.indexOf(r)==0)return i[s].selected=!0},this.list=document.createElement("SELECT"),this.list.className="dhx_combo_select",this.list.style.width=this.cell.offsetWidth+"px",this.list.style.left=e[0]+"px",this.list.style.top=e[1]+this.cell.offsetHeight+"px",this.list.onclick=function(e){var n=e||window.event,r=n.target||n.srcElement;r.tagName=="OPTION"&&(r=r.parentNode),t.editable=!1,t.grid.editStop(),n.cancelBubble=!0};for(var n=this.combo.getKeys(),r=!1,i=0,s=0;s<n.length;s++){var o=this.combo.get(n[s]);this.list.options[this.list.options.length]=new Option(o,n[s]),n[s]==this.val&&(i=this.list.options.length-1,r=!0)}r==0&&(this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val),i=this.list.options.length-1),document.body.appendChild(this.list),this.list.size="6",this.cstate=1,this.editable?this.cell.innerHTML="":(this.obj.style.width="1px",this.obj.style.height="1px"),this.cell.appendChild(this.obj),this.list.options[i].selected=!0;if(!_isFF||this.editable)this.obj.focus(),this.obj.focus();this.editable||(this.obj.style.visibility="hidden",this.list.focus(),this.list.onkeydown=function(e){e=e||window.event,t.grid.setActive(!0);if(e.keyCode<30)return t.grid.doKey({target:t.cell,keyCode:e.keyCode,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey})})},this.getValue=function(){return this.cell.combo_value==window.undefined?"":this.cell.combo_value},this.detach=function(){this.val!=this.getValue()&&(this.cell.wasChanged=!0);if(this.list.parentNode!=null)if(this.editable){var e=this.list.options[this.list.selectedIndex];if(e&&e.text==this.obj.value)this.setValue(this.list.value);else{var t=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),n=t.values._dhx_find(this.obj.value);n!=-1?this.setValue(t.keys[n]):this.setCValue(this.cell.combo_value=this.obj.value)}}else this.setValue(this.list.value);return this.list.parentNode&&this.list.parentNode.removeChild(this.list),this.obj.parentNode&&this.obj.parentNode.removeChild(this.obj),this.val!=this.getValue()}}function eXcell_coro(e){this.base=eXcell_co,this.base(e),this.editable=!1}function eXcell_cotxt(e){this.base=eXcell_co,this.base(e)}function eXcell_corotxt(e){this.base=eXcell_co,this.base(e),this.editable=!1}function eXcell_cp(e){try{this.cell=e,this.grid=this.cell.parentNode.grid}catch(t){}this.edit=function(){this.val=this.getValue(),this.obj=document.createElement("SPAN"),this.obj.style.border="1px solid black",this.obj.style.position="absolute";var e=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj),document.body.appendChild(this.obj),this.obj.style.left=e[0]+"px",this.obj.style.zIndex=1e3,this.obj.style.top=e[1]+this.cell.offsetHeight+"px"},this.toolDNum=function(e){return e.length==1&&(e="0"+e),e},this.colorPanel=function(e,t){var n=document.createElement("TABLE");t.appendChild(n),n.cellSpacing=0,n.editor_obj=this,n.style.cursor="default",n.onclick=function(e){var t=e||window.event,n=t.target||t.srcElement,r=n.parentNode.parentNode.parentNode.editor_obj;r.setValue(n._bg),r.grid.editStop()};for(var r=256/e,i=0;i<=256/r;i++)for(var s=n.insertRow(i),o=0;o<=256/r;o++)for(var u=0;u<=256/r;u++){R=new Number(r*i)-(i==0?0:1),G=new Number(r*o)-(o==0?0:1),B=new Number(r*u)-(u==0?0:1);var a=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16)),f=s.insertCell(o);f.width="10px",f.innerHTML="&nbsp;",f.title=a.toUpperCase(),f.style.backgroundColor="#"+a,f._bg="#"+a,this.val!=null&&"#"+a.toUpperCase()==this.val.toUpperCase()&&(f.style.border="2px solid white")}},this.getValue=function(){return this.cell.firstChild._bg||""},this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))},this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))},this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))},this.detach=function(){return this.obj.offsetParent!=null&&document.body.removeChild(this.obj),this.val!=this.getValue()}}function eXcell_img(e){try{this.cell=e,this.grid=this.cell.parentNode.grid}catch(t){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG")return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");if(this.cell.firstChild.tagName=="A"){var e=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");return e+="^"+this.cell.lnk,this.cell.trg&&(e+="^"+this.cell.trg),e}},this.isDisabled=function(){return!0}}function eXcell_price(e){this.base=eXcell_ed,this.base(e),this.getValue=function(){return this.cell.childNodes.length>1?this.cell.childNodes[1].innerHTML.toString()._dhx_trim():"0"}}function eXcell_dyn(e){this.base=eXcell_ed,this.base(e),this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}function eXcell_ro(e){e&&(this.cell=e,this.grid=this.cell.parentNode.grid),this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}function eXcell_ron(e){this.cell=e,this.grid=this.cell.parentNode.grid,this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)}}function eXcell_rotxt(e){this.cell=e,this.grid=this.cell.parentNode.grid,this.edit=function(){},this.isDisabled=function(){return!0},this.setValue=function(e){e?this.cell._clearCell=!1:(e=" ",this.cell._clearCell=!0),this.setCTxtValue(e)},this.getValue=function(){return this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent}}function dhtmlXGridComboObject(){return this.keys=new dhtmlxArray,this.values=new dhtmlxArray,this.put=function(e,t){for(var n=0;n<this.keys.length;n++)if(this.keys[n]==e)return this.values[n]=t,!0;this.values[this.values.length]=t,this.keys[this.keys.length]=e},this.get=function(e){for(var t=0;t<this.keys.length;t++)if(this.keys[t]==e)return this.values[t];return null},this.clear=function(){this.keys=new dhtmlxArray,this.values=new dhtmlxArray},this.remove=function(e){for(var t=0;t<this.keys.length;t++)if(this.keys[t]==e)return this.keys._dhx_removeAt(t),this.values._dhx_removeAt(t),!0},this.size=function(){for(var e=0,t=0;t<this.keys.length;t++)this.keys[t]!=null&&e++;return e},this.getKeys=function(){for(var e=[],t=0;t<this.keys.length;t++)this.keys[t]!=null&&(e[e.length]=this.keys[t]);return e},this.save=function(){this._save=[];for(var e=0;e<this.keys.length;e++)this._save[e]=[this.keys[e],this.values[e]]},this.restore=function(){if(this._save){this.keys[e]=[],this.values[e]=[];for(var e=0;e<this._save.length;e++)this.keys[e]=this._save[e][0],this.values[e]=this._save[e][1]}},this}function Hashtable(){return this.keys=new dhtmlxArray,this.values=new dhtmlxArray,this}dhtmlXGridCellObject.prototype={getAttribute:function(e){return this.cell._attrs[e]},setAttribute:function(e,t){this.cell._attrs[e]=t},getInput:function(){if(!this.obj||this.obj.tagName!="INPUT"&&this.obj.tagName!="TEXTAREA"){var e=(this.obj||this.cell).getElementsByTagName("TEXTAREA");return e.length||(e=(this.obj||this.cell).getElementsByTagName("INPUT")),e[0]}return this.obj}},dhtmlXGridCellObject.prototype.setValue=function(e){typeof e=="number"||!!e&&e.toString()._dhx_trim()!=""?this.cell._clearCell=!1:(e="&nbsp;",this.cell._clearCell=!0),this.setCValue(e)},dhtmlXGridCellObject.prototype.getTitle=function(){return _isIE?this.cell.innerText:this.cell.textContent},dhtmlXGridCellObject.prototype.setCValue=function(e){this.cell.innerHTML=e},dhtmlXGridCellObject.prototype.setCTxtValue=function(e){this.cell.innerHTML="",this.cell.appendChild(document.createTextNode(e))},dhtmlXGridCellObject.prototype.setLabel=function(e){this.cell.innerHTML=e},dhtmlXGridCellObject.prototype.getMath=function(){return this._val?this.val:this.getValue()},eXcell.prototype=new dhtmlXGridCellObject,eXcell_ed.prototype=new eXcell,eXcell_edtxt.prototype=new eXcell_ed,eXcell_ch.prototype=new eXcell,eXcell_ch.prototype.setValue=function(e){this.cell.style.verticalAlign="middle",e&&(e=e.toString()._dhx_trim(),e=="false"||e=="0")&&(e=""),e?(e="1",this.cell.chstate="1"):(e="0",this.cell.chstate="0");var t=this;this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+e+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)},eXcell_ra.prototype=new eXcell_ch,eXcell_ra.prototype.setValue=function(e){this.cell.style.verticalAlign="middle",e&&(e=e.toString()._dhx_trim(),e=="false"||e=="0")&&(e="");if(e){this.grid._RaSeCol||(this.grid._RaSeCol=[]);if(this.grid._RaSeCol[this.cell._cellIndex]){var t=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);t.setValue("0"),this.grid.rowsAr[t.cell.parentNode.idd]&&this.grid.callEvent("onEditCell",[1,t.cell.parentNode.idd,t.cell._cellIndex])}this.grid._RaSeCol[this.cell._cellIndex]=this.cell,e="1",this.cell.chstate="1"}else e="0",this.cell.chstate="0";this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+e+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)},eXcell_txt.prototype=new eXcell,eXcell_txttxt.prototype=new eXcell_txt,eXcell_txt.prototype.setValue=function(e){!e||e.toString()._dhx_trim()==""?(e="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1,this.cell._brval=e,this.grid.multiLine?this.setCValue(e.replace(/\n/g,"<br/>"),e):this.setCValue(e,e)},eXcell_co.prototype=new eXcell,eXcell_co.prototype.getText=function(){return this.cell.innerHTML},eXcell_co.prototype.setValue=function(e){if(typeof e=="object"){var t=this.grid.xmlLoader.doXPath("./option",e);t.length&&(this.cell._combo=new dhtmlXGridComboObject);for(var n=0;n<t.length;n++)this.cell._combo.put(t[n].getAttribute("value"),t[n].firstChild?t[n].firstChild.data:"");e=e.firstChild.data}(e||"").toString()._dhx_trim()==""&&(e=null),this.cell.combo_value=e;if(e!==null){var r=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(e);this.setCValue(r===null?e:r,e)}else this.setCValue("&nbsp;",e)},eXcell_coro.prototype=new eXcell_co,eXcell_cotxt.prototype=new eXcell_co,eXcell_cotxt.prototype.getText=function(){return _isIE?this.cell.innerText:this.cell.textContent},eXcell_cotxt.prototype.setValue=function(e){if(typeof e=="object"){var t=this.grid.xmlLoader.doXPath("./option",e);t.length&&(this.cell._combo=new dhtmlXGridComboObject);for(var n=0;n<t.length;n++)this.cell._combo.put(t[n].getAttribute("value"),t[n].firstChild?t[n].firstChild.data:"");e=e.firstChild.data}(e||"").toString()._dhx_trim()==""&&(e=null),e!==null?this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(e)||e,e):this.setCTxtValue(" ",e),this.cell.combo_value=e},eXcell_corotxt.prototype=new eXcell_cotxt,eXcell_cp.prototype=new eXcell,eXcell_cp.prototype.setValue=function(e){this.setCValue("<div style='width:100%;height:"+(this.grid.multiLine?this.cell.offsetHeight-2:16)+";background-color:"+(e||"")+";border:0px;'>&nbsp;</div>",e),this.cell.firstChild._bg=e},eXcell_img.prototype=new eXcell,eXcell_img.prototype.getTitle=function(){return this.cell._brval},eXcell_img.prototype.setValue=function(e){var t=e;if(e.indexOf("^")!=-1){var n=e.split("^"),e=n[0],t=this.cell._attrs.title||n[1];n.length>2&&(this.cell.lnk=n[2],n[3])&&(this.cell.trg=n[3]),this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(e||"")._dhx_trim()+"' border='0'>",e),this.cell.lnk&&(this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>"),this.cell._brval=t},eXcell_price.prototype=new eXcell_ed,eXcell_price.prototype.setValue=function(e){isNaN(parseFloat(e))&&(e=this.val||0);var t="green";e<0&&(t="red"),this.setCValue("<span>$</span><span style='padding-right:2px;color:"+t+";'>"+e+"</span>",e)},eXcell_dyn.prototype=new eXcell_ed,eXcell_dyn.prototype.setValue=function(e){(!e||isNaN(Number(e)))&&e!==""&&(e=0);if(e>0)var t="green",n="dyn_up.gif";else e==0?(t="black",n="dyn_.gif"):(t="red",n="dyn_down.gif");this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+""+n+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+t+";'>"+e+"</span></div>",e)},eXcell_ro.prototype=new eXcell,eXcell_ron.prototype=new eXcell,eXcell_ron.prototype.setValue=function(e){if(e!==0&&(!e||e.toString()._dhx_trim()==""))return this.setCValue("&nbsp;"),this.cell._clearCell=!0;this.cell._clearCell=!1,this.setCValue(e?this.grid._aplNF(e,this.cell._cellIndex):"0")},eXcell_rotxt.prototype=new eXcell,Hashtable.prototype=new dhtmlXGridComboObject;