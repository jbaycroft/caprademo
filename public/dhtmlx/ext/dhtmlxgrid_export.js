//v.3.5 build 120822
/*
Copyright DHTMLX LTD. http://www.dhtmlx.com
You allowed to use this component or parts of it under GPL terms
To use it on other terms or get Professional edition of the component please contact us at sales@dhtmlx.com
*/
dhtmlXGridObject.prototype.toPDF=function(e,t,n,r,i,s){function o(e){for(var t=[],i=1;i<v.hdr.rows.length;i++){t[i]=[];for(var s=0;s<v._cCount;s++){var o=v.hdr.rows[i].childNodes[s];t[i][s]||(t[i][s]=[0,0]),o&&(t[i][o._cellIndexS]=[o.colSpan,o.rowSpan])}}var u="<rows profile='"+e+"'";n&&(u+=" header='"+n+"'"),r&&(u+=" footer='"+r+"'"),u+="><head>"+v._serialiseExportConfig(t).replace(/^<head/,"<columns").replace(/head>$/,"columns>");for(i=2;i<v.hdr.rows.length;i++){for(var f=0,l=v.hdr.rows[i],c="",s=0;s<v._cCount;s++)if(v._srClmn&&!v._srClmn[s]||v._hrrar[s]&&(!v._fake||s>=v._fake.hdrLabels.length))f++;else{var h=t[i][s],p=h[0]&&h[0]>1?' colspan="'+h[0]+'" ':"";h[1]&&h[1]>1&&(p+=' rowspan="'+h[1]+'" ',f=-1);for(var d="",m=0;m<l.cells.length;m++)if(l.cells[m]._cellIndexS==s){d=l.cells[m].getElementsByTagName("SELECT").length?"":_isIE?l.cells[m].innerText:l.cells[m].textContent,d=d.replace(/[ \n\r\t\xA0]+/," ");break}(!d||d==" ")&&f++,c+="<column"+p+"><![CDATA["+d+"]]></column>"}f!=v._cCount&&(u+="\n<columns>"+c+"</columns>")}return u+="</head>\n",u+=a(),u}function u(){var e=[];if(i)for(var t=0;t<i.length;t++)e.push(l(v.getRowIndex(i[t])));else for(t=0;t<v.getRowsNum();t++)e.push(l(t));return e.join("\n")}function a(){var e=["<foot>"];if(!v.ftr)return"";for(var t=1;t<v.ftr.rows.length;t++){e.push("<columns>");for(var n=v.ftr.rows[t],r=0;r<v._cCount;r++)if(!v._srClmn||v._srClmn[r])if(!v._hrrar[r]||v._fake&&!(r>=v._fake.hdrLabels.length)){for(var i=0;i<n.cells.length;i++){var s="",o="";if(n.cells[i]._cellIndexS==r){s=_isIE?n.cells[i].innerText:n.cells[i].textContent,s=s.replace(/[ \n\r\t\xA0]+/," "),n.cells[i].colSpan&&n.cells[i].colSpan!=1&&(o=" colspan='"+n.cells[i].colSpan+"' "),n.cells[i].rowSpan&&n.cells[i].rowSpan!=1&&(o=" rowspan='"+n.cells[i].rowSpan+"' ");break}}e.push("<column"+o+"><![CDATA["+s+"]]></column>")}e.push("</columns>")}return e.push("</foot>"),e.join("\n")}function f(e,t){return(window.getComputedStyle?window.getComputedStyle(e,null)[t]:e.currentStyle?e.currentStyle[t]:null)||""}function l(e){if(!v.rowsBuffer[e])return"";var t=v.render_row(e);if(t.style.display=="none")return"";for(var n=v.isTreeGrid()?' level="'+v.getLevel(t.idd)+'"':"",r="<row"+n+">",i=0;i<v._cCount;i++)if((!v._srClmn||v._srClmn[i])&&(!v._hrrar[i]||v._fake&&i<v._fake.hdrLabels.length)){var s=v.cells(t.idd,i);if(d){var o=f(s.cell,"color"),u=f(s.cell,"backgroundColor"),a=f(s.cell,"font-weight")||f(s.cell,"fontWeight"),l=f(s.cell,"font-style")||f(s.cell,"fontStyle"),c=f(s.cell,"text-align")||f(s.cell,"textAlign"),h=f(s.cell,"font-family")||f(s.cell,"fontFamily");if(u=="transparent"||u=="rgba(0, 0, 0, 0)")u="rgb(255,255,255)";r+="<cell bgColor='"+u+"' textColor='"+o+"' bold='"+a+"' italic='"+l+"' align='"+c+"' font='"+h+"'>"}else r+="<cell>";r+="<![CDATA["+(s.getContent?s.getContent():s.getTitle())+"]]></cell>"}return r+"</row>"}function c(){var e="</rows>";return e}var h={row:this.getSelectedRowId(),col:this.getSelectedCellIndex()};if(h.row===null||h.col===-1)h=!1;else{var p=this.cells(h.row,h.col).cell;p.parentNode.className=p.parentNode.className.replace(" rowselected",""),p.className=p.className.replace(" cellselected",""),h.el=p}var t=t||"color",d=t=="full_color",v=this;v._asCDATA=!0,this.target=typeof s=="undefined"?' target="_blank"':s,eXcell_ch.prototype.getContent=function(){return this.getValue()},eXcell_ra.prototype.getContent=function(){return this.getValue()};var m=document.createElement("div");m.style.display="none",document.body.appendChild(m);var g="form_"+v.uid();m.innerHTML='<form id="'+g+'" method="post" action="'+e+'" accept-charset="utf-8"  enctype="application/x-www-form-urlencoded"'+this.target+'><input type="hidden" name="grid_xml" id="grid_xml"/> </form>',document.getElementById(g).firstChild.value=encodeURIComponent(o(t).replace("â€“","-")+u()+c()),document.getElementById(g).submit(),m.parentNode.removeChild(m),v=null,h&&(h.el.parentNode.className+=" rowselected",h.el.className+=" cellselected"),h=null},dhtmlXGridObject.prototype._serialiseExportConfig=function(e){function t(e){return typeof e!="string"?e:(e=e.replace(/&/g,"&amp;"),e=e.replace(/"/g,"&quot;"),e=e.replace(/'/g,"&apos;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"))}for(var n="<head>",r=0;r<this.hdr.rows[0].cells.length;r++)if(!this._srClmn||this._srClmn[r])if(!this._hrrar[r]||this._fake&&!(r>=this._fake.hdrLabels.length)){var i=this.fldSort[r];i=="cus"&&(i=this._customSorts[r].toString(),i=i.replace(/function[\ ]*/,"").replace(/\([^\f]*/,""));var s=e[1][r],o=(s[1]&&s[1]>1?' rowspan="'+s[1]+'" ':"")+(s[0]&&s[0]>1?' colspan="'+s[0]+'" ':"");n+="<column "+o+" width='"+this.getColWidth(r)+"' align='"+this.cellAlign[r]+"' type='"+this.cellType[r]+"' hidden='"+(this.isColumnHidden&&this.isColumnHidden(r)?"true":"false")+"' sort='"+(i||"na")+"' color='"+(this.columnColor[r]||"")+"'"+(this.columnIds[r]?" id='"+this.columnIds[r]+"'":"")+">",n+=this._asCDATA?"<![CDATA["+this.getHeaderCol(r)+"]]>":this.getHeaderCol(r);var u=this.getCombo(r);if(u)for(var a=0;a<u.keys.length;a++)n+="<option value='"+t(u.keys[a])+"'><![CDATA["+u.values[a]+"]]></option>";n+="</column>"}return n+="</head>"},window.eXcell_sub_row_grid&&(window.eXcell_sub_row_grid.prototype.getContent=function(){return""}),dhtmlXGridObject.prototype.toExcel=function(e,t,n,r,i){if(!document.getElementById("ifr")){var s=document.createElement("iframe");s.style.display="none",s.setAttribute("name","dhx_export_iframe"),s.setAttribute("src",""),s.setAttribute("id","dhx_export_iframe"),document.body.appendChild(s)}var o=' target="dhx_export_iframe"';this.toPDF(e,t,n,r,i,o)};