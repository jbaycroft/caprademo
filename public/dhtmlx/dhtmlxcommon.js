//v.3.5 build 120822
/*
Copyright DHTMLX LTD. http://www.dhtmlx.com
You allowed to use this component or parts of it under GPL terms
To use it on other terms or get Professional edition of the component please contact us at sales@dhtmlx.com
*/
function dtmlXMLLoaderObject(e,t,n,r){return this.xmlDoc="",this.async=typeof n!="undefined"?n:!0,this.onloadAction=e||null,this.mainObject=t||null,this.waitCall=null,this.rSeed=r||!1,this}function callerFunction(e,t){return this.handler=function(n){return n||(n=window.event),e(n,t),!0}}function getAbsoluteLeft(e){return getOffset(e).left}function getAbsoluteTop(e){return getOffset(e).top}function getOffsetSum(e){for(var t=0,n=0;e;)t+=parseInt(e.offsetTop),n+=parseInt(e.offsetLeft),e=e.offsetParent;return{top:t,left:n}}function getOffsetRect(e){var t=e.getBoundingClientRect(),n=document.body,r=document.documentElement,i=window.pageYOffset||r.scrollTop||n.scrollTop,s=window.pageXOffset||r.scrollLeft||n.scrollLeft,o=r.clientTop||n.clientTop||0,u=r.clientLeft||n.clientLeft||0,a=t.top+i-o,f=t.left+s-u;return{top:Math.round(a),left:Math.round(f)}}function getOffset(e){return e.getBoundingClientRect?getOffsetRect(e):getOffsetSum(e)}function convertStringToBoolean(e){typeof e=="string"&&(e=e.toLowerCase());switch(e){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(e){return e.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.dragStartObject=this.dragStartNode=this.dragNode=this.lastLanding=0,this.tempDOMM=this.tempDOMU=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function j(){return this.catches||(this.catches=[]),this}function dhtmlXHeir(e,t){for(var n in t)typeof t[n]=="function"&&(e[n]=t[n]);return e}function dhtmlxEvent(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}dhtmlx=function(e){for(var t in e)dhtmlx[t]=e[t];return dhtmlx},dhtmlx.extend_api=function(e,t,n){var r=window[e];r&&(window[e]=function(e){if(e&&typeof e=="object"&&!e.tagName){var n=r.apply(this,t._init?t._init(e):arguments),i;for(i in dhtmlx)t[i]&&this[t[i]](dhtmlx[i]);for(i in e)t[i]?this[t[i]](e[i]):i.indexOf("on")==0&&this.attachEvent(i,e[i])}else n=r.apply(this,arguments);return t._patch&&t._patch(this),n||this},window[e].prototype=r.prototype,n&&dhtmlXHeir(window[e].prototype,n))},dhtmlxAjax={get:function(e,t){var n=new dtmlXMLLoaderObject(!0);return n.async=arguments.length<3,n.waitCall=t,n.loadXML(e),n},post:function(e,t,n){var r=new dtmlXMLLoaderObject(!0);return r.async=arguments.length<4,r.waitCall=n,r.loadXML(e,!0,t),r},getSync:function(e){return this.get(e,null,!0)},postSync:function(e,t){return this.post(e,t,null,!0)}},dtmlXMLLoaderObject.count=0,dtmlXMLLoaderObject.prototype.waitLoadFunction=function(e){var t=!0;return this.check=function(){e&&e.onloadAction!=null&&(!e.xmlDoc.readyState||e.xmlDoc.readyState==4)&&t&&(t=!1,dtmlXMLLoaderObject.count++,typeof e.onloadAction=="function"&&e.onloadAction(e.mainObject,null,null,null,e),e.waitCall&&(e.waitCall.call(this,e),e.waitCall=null))}},dtmlXMLLoaderObject.prototype.getXMLTopNode=function(e,t){if(this.xmlDoc.responseXML){var n=this.xmlDoc.responseXML.getElementsByTagName(e);n.length==0&&e.indexOf(":")!=-1&&(n=this.xmlDoc.responseXML.getElementsByTagName(e.split(":")[1]));var r=n[0]}else r=this.xmlDoc.documentElement;return r?(this._retry=!1,r):this._retry?(dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),document.createElement("DIV")):(this._retry=!0,t=this.xmlDoc,this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(e,t))},dtmlXMLLoaderObject.prototype.loadXMLString=function(e,t){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(e);else{var n=new DOMParser;this.xmlDoc=n.parseFromString(e,"text/xml")}t||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))},dtmlXMLLoaderObject.prototype.loadXML=function(e,t,n,r){this.rSeed&&(e+=(e.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf()),this.filePath=e,this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)),this.xmlDoc.open(t?"POST":"GET",e,this.async),r?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):t&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xmlDoc.send(n),this.async||(new this.waitLoadFunction(this))()},dtmlXMLLoaderObject.prototype.destructor=function(){return this.setXSLParamValue=this.getXMLTopNode=this.xmlNodeToJSON=this.doSerialization=this.loadXMLString=this.loadXML=this.doXSLTransToString=this.doXSLTransToObject=this.doXPathOpera=this.doXPath=this.xmlDoc=this.mainObject=this.onloadAction=this.filePath=this.rSeed=this.async=this._retry=this._getAllNamedChilds=this._filterXPath=null},dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(e){for(var t={},n=0;n<e.attributes.length;n++)t[e.attributes[n].name]=e.attributes[n].value;t._tagvalue=e.firstChild?e.firstChild.nodeValue:"";for(n=0;n<e.childNodes.length;n++){var r=e.childNodes[n].tagName;r&&(t[r]||(t[r]=[]),t[r].push(this.xmlNodeToJSON(e.childNodes[n])))}return t},dhtmlDragAndDropObject.prototype.removeDraggableItem=function(e){e.onmousedown=null,e.dragStarter=null,e.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(e,t){e.onmousedown=this.preCreateDragCopy,e.dragStarter=t,this.addDragLanding(e,t)},dhtmlDragAndDropObject.prototype.addDragLanding=function(e,t){e.dragLanding=t},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(e){if(!e&&!window.event||(e||event).button!=2)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(e),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),e&&e.preventDefault&&e.preventDefault(),!1)},dhtmlDragAndDropObject.prototype.callDrag=function(e){e||(e=window.event),dragger=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(e,!0);dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,e);if(!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var t=dragger.gldragNode;dragger.gldragNode.old&&(t=dragger.gldragNode.old),t.parentNode.removeChild(t);var n=dragger.dragNode.pWindow;t.pWindow&&t.pWindow.dhtmlDragAndDrop.lastLanding&&t.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(t.pWindow.dhtmlDragAndDrop.lastLanding);if(_isIE){var r=document.createElement("Div");r.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=r.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),n.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=e.clientX+15+(dragger.fx?dragger.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=e.clientY+3+(dragger.fy?dragger.fy*-1:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";var i=e.srcElement?e.srcElement:e.target;dragger.checkLanding(i,e)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){if(window.name){for(var t=parent.frames[window.name].frameElement.offsetParent,n=0,r=0;t;)n+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;if(parent.dhtmlDragAndDrop){var i=parent.dhtmlDragAndDrop.calculateFramePosition(1);n+=i.split("_")[0]*1,r+=i.split("_")[1]*1}if(e)return n+"_"+r;this.fx=n,this.fy=r}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(e,t){e&&e.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=e,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,t.clientX,t.clientY,t),this.lastLanding_scr=_isIE?t.srcElement:t.target):e&&e.tagName!="BODY"?this.checkLanding(e.parentNode,t):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,t.clientX,t.clientY,t),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(e,t){dragger=window.dhtmlDragAndDrop;if(!t){dragger.stopFrameRoute();var n=dragger.lastLanding;dragger.lastLanding=null,n&&n.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,n,_isIE?event.srcElement:e.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(e){e&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var t=0;t<window.frames.length;t++)try{window.frames[t]!=e&&window.frames[t].dhtmlDragAndDrop&&window.frames[t].dhtmlDragAndDrop.stopFrameRoute(window)}catch(n){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(r){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(e,t){e&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=e.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=e.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=e.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=e.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&t&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(n){}for(var r=0;r<window.frames.length;r++)try{window.frames[r]!=e&&window.frames[r].dhtmlDragAndDrop&&window.frames[r].dhtmlDragAndDrop.initFrameRoute(window,!e||t?1:0)}catch(i){}},_OperaRv=_KHTMLrv=_FFrv=_isChrome=_isMacOS=_isKHTML=_isOpera=_isIE=_isFF=!1,navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);if(navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1)_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0;else if(navigator.userAgent.indexOf("Opera")!=-1)_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3));else if(navigator.appName.indexOf("Microsoft")!=-1){if(_isIE=!0,(navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1)&&document.compatMode!="BackCompat")_isIE=8}else _isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]);dtmlXMLLoaderObject.prototype.doXPath=function(e,t,n,r){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(e,t);if(_isIE)return t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),n!=null&&t.setProperty("SelectionNamespaces","xmlns:xsl='"+n+"'"),r=="single"?t.selectSingleNode(e):t.selectNodes(e)||[];var i=t;t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),t.nodeName.indexOf("document")!=-1?i=t:(i=t,t=t.ownerDocument);var s=XPathResult.ANY_TYPE;r=="single"&&(s=XPathResult.FIRST_ORDERED_NODE_TYPE);var o=[],u=t.evaluate(e,i,function(){return n},s,null);if(s==XPathResult.FIRST_ORDERED_NODE_TYPE)return u.singleNodeValue;for(var a=u.iterateNext();a;)o[o.length]=a,a=u.iterateNext();return o},j.prototype.catchError=function(e,t){this.catches[e]=t},j.prototype.throwError=function(e,t,n){return this.catches[e]?this.catches[e](e,t,n):this.catches.ALL?this.catches.ALL(e,t,n):(alert("Error type: "+e+"\nDescription: "+t),null)},window.dhtmlxError=new j,dtmlXMLLoaderObject.prototype.doXPathOpera=function(e,t){var n=e.replace(/[\/]+/gi,"/").split("/"),r=null,i=1;if(!n.length)return[];if(n[0]==".")r=[t];else{if(n[0]!="")return[];r=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(n[i].replace(/\[[^\]]*\]/g,"")),i++}for(;i<n.length;i++)r=this._getAllNamedChilds(r,n[i]);return n[i-1].indexOf("[")!=-1&&(r=this._filterXPath(r,n[i-1])),r},dtmlXMLLoaderObject.prototype._filterXPath=function(e,t){for(var n=[],t=t.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),r=0;r<e.length;r++)e[r].getAttribute(t)&&(n[n.length]=e[r]);return n},dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,t){var n=[];_isKHTML&&(t=t.toUpperCase());for(var r=0;r<e.length;r++)for(var i=0;i<e[r].childNodes.length;i++)_isKHTML?e[r].childNodes[i].tagName&&e[r].childNodes[i].tagName.toUpperCase()==t&&(n[n.length]=e[r].childNodes[i]):e[r].childNodes[i].tagName==t&&(n[n.length]=e[r].childNodes[i]);return n},dtmlXMLLoaderObject.prototype.xslDoc=null,dtmlXMLLoaderObject.prototype.setXSLParamValue=function(e,t,n){n||(n=this.xslDoc),n.responseXML&&(n=n.responseXML);var r=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+e+"']",n,"http://www.w3.org/1999/XSL/Transform","single");r!=null&&(r.firstChild.nodeValue=t)},dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(e,t){e||(e=this.xslDoc),e.responseXML&&(e=e.responseXML),t||(t=this.xmlDoc),t.responseXML&&(t=t.responseXML);if(_isIE){r=new ActiveXObject("Msxml2.DOMDocument.3.0");try{t.transformNodeToObject(e,r)}catch(n){r=t.transformNode(e)}}else{this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(e));var r=this.XSLProcessor.transformToDocument(t)}return r},dtmlXMLLoaderObject.prototype.doXSLTransToString=function(e,t){var n=this.doXSLTransToObject(e,t);return typeof n=="string"?n:this.doSerialization(n)},dtmlXMLLoaderObject.prototype.doSerialization=function(e){e||(e=this.xmlDoc),e.responseXML&&(e=e.responseXML);if(_isIE)return e.xml;var t=new XMLSerializer;return t.serializeToString(e)},dhtmlxEventable=function(a){a.attachEvent=function(e,t,n){return e="ev_"+e.toLowerCase(),this[e]||(this[e]=new this.eventCatcher(n||this)),e+":"+this[e].addEvent(t)},a.callEvent=function(e,t){return e="ev_"+e.toLowerCase(),this[e]?this[e].apply(this,t):!0},a.checkEvent=function(e){return!!this["ev_"+e.toLowerCase()]},a.eventCatcher=function(a){var c=[],d=function(){for(var e=!0,t=0;t<c.length;t++)if(c[t]!=null)var n=c[t].apply(a,arguments),e=e&&n;return e};return d.addEvent=function(a){return typeof a!="function"&&(a=eval(a)),a?c.push(a)-1:!1},d.removeEvent=function(e){c[e]=null},d},a.detachEvent=function(e){if(e!=0){var t=e.split(":");this[t[0]].removeEvent(t[1])}},a.detachAllEvents=function(){for(var e in this)e.indexOf("ev_")==0&&delete this[e]},a=null};